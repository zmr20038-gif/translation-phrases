<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexiFlow - ä¸“æ³¨å­¦ä¹ ä¸æ£€ç´¢</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&family=Noto+Serif+SC:wght@700&display=swap" rel="stylesheet">
    <style>
        body { transition: background-color 0.4s; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .glass-card { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.4); }
        .dark-mode { background-color: #0f1115 !important; color: #cbd5e1 !important; }
        .dark-mode .glass-card { background: rgba(30, 32, 38, 0.8); border: 1px solid rgba(255,255,255,0.05); }
        .view-hidden { display: none; }
        .dock-item-active { color: #3b82f6; transform: translateY(-4px); font-weight: bold; }
        .memory-dot { display: inline-block; width: 6px; height: 6px; border-radius: 50%; margin-right: 2px; }
        .scroll-hide::-webkit-scrollbar { display: none; }
        .serif-title { font-family: 'Noto Serif SC', serif; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-24">

    <section id="view-learn" class="px-6 pt-12 max-w-2xl mx-auto">
        <header class="mb-10 text-center">
            <h1 class="text-xs uppercase tracking-[0.3em] text-gray-400 mb-2 font-bold">Smart Review</h1>
            <div class="flex justify-center space-x-12">
                <div><p class="text-4xl font-bold serif-title" id="dash-learned">0</p><p class="text-[10px] text-gray-400 uppercase mt-1">å·²æŒæ¡</p></div>
                <div class="w-[1px] h-12 bg-gray-200 dark:bg-gray-800 mt-2"></div>
                <div><p class="text-4xl font-bold text-blue-500 serif-title" id="dash-review">0</p><p class="text-[10px] text-gray-400 uppercase mt-1">éœ€å¤ä¹ </p></div>
            </div>
        </header>

        <div id="learn-card-container" class="space-y-6">
            </div>
        
        <div id="learn-empty" class="text-center py-24 view-hidden">
            <div class="text-6xl mb-6">ğŸ†</div>
            <p class="text-gray-500 font-medium">ä»»åŠ¡å·²è¾¾æˆï¼å½“å‰æ²¡æœ‰å¾…å¤ä¹ è¯æ¡</p>
            <button onclick="switchView('search')" class="mt-6 px-8 py-3 bg-blue-500 text-white rounded-full shadow-lg hover:shadow-xl transition-all">å»æ¢ç´¢æ–°è¯æ¡</button>
        </div>
    </section>

    <section id="view-search" class="px-6 pt-12 max-w-2xl mx-auto view-hidden">
        <div class="glass-card rounded-[2.5rem] p-10 mb-10 text-center shadow-sm relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-400 to-indigo-500"></div>
            <span class="text-[10px] text-blue-500 font-bold uppercase tracking-widest">Featured Card</span>
            <h2 id="feat-en" class="text-5xl font-bold my-5 serif-title tracking-tight text-slate-800 dark:text-white">...</h2>
            <p id="feat-zh" class="text-xl text-gray-500 mb-4">åŠ è½½ä¸­</p>
            <p id="feat-detail" class="text-sm text-gray-400 max-w-xs mx-auto italic"></p>
        </div>

        <div class="sticky top-6 z-50 mb-10">
            <input type="text" id="global-search" oninput="renderSearch()" placeholder="æœç´¢ 90+ è¡Œä¸šè¯åº“..." 
                class="w-full glass-card px-8 py-5 rounded-3xl shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-500/10 transition-all text-lg">
        </div>

        <nav class="flex space-x-3 mb-8 overflow-x-auto scroll-hide pb-2">
            <button onclick="setCategory('all')" id="cat-all" class="flex-none px-6 py-2 rounded-full glass-card text-xs font-bold transition-all shadow-sm">ALL</button>
            <button onclick="setCategory('legal')" id="cat-legal" class="flex-none px-6 py-2 rounded-full glass-card text-xs font-bold transition-all shadow-sm">âš–ï¸ æ³•å¾‹</button>
            <button onclick="setCategory('gaming')" id="cat-gaming" class="flex-none px-6 py-2 rounded-full glass-card text-xs font-bold transition-all shadow-sm">ğŸ® æ¸¸æˆ</button>
            <button onclick="setCategory('food')" id="cat-food" class="flex-none px-6 py-2 rounded-full glass-card text-xs font-bold transition-all shadow-sm">ğŸ± é£Ÿç‰©</button>
        </nav>

        <div id="search-results" class="space-y-4"></div>
    </section>

    <nav class="fixed bottom-8 left-1/2 -translate-x-1/2 w-[300px] h-20 glass-card rounded-[2.5rem] shadow-2xl flex items-center justify-around px-8 z-[100] border-t border-white/50">
        <button onclick="switchView('learn')" id="dock-learn" class="transition-all duration-300 text-gray-400 flex flex-col items-center">
            <span class="text-2xl mb-1">ğŸ“–</span>
            <span class="text-[9px] font-black uppercase tracking-tighter">Learn</span>
        </button>
        <button onclick="switchView('search')" id="dock-search" class="transition-all duration-300 dock-item-active flex flex-col items-center">
            <span class="text-2xl mb-1">ğŸ”</span>
            <span class="text-[9px] font-black uppercase tracking-tighter">Search</span>
        </button>
        <button onclick="toggleDarkMode()" class="text-gray-400 flex flex-col items-center">
            <span id="dark-icon" class="text-2xl mb-1">ğŸŒ™</span>
            <span class="text-[9px] font-black uppercase tracking-tighter">Theme</span>
        </button>
    </nav>

    <script>
        const vocabulary = {
            legal: [
                { id: 'l1', en: "Without Prejudice", zh: "ä¸æŸå®³ï¼›æ— åè§", detail: "ä¸æ„æˆå¯¹è‡ªèº«æƒåˆ©çš„æ”¾å¼ƒæˆ–å¯¹äº‹å®çš„æ‰¿è®¤ã€‚", context: "Litigation" },
                { id: 'l2', en: "Indemnification", zh: "è¡¥å¿ï¼›èµ”å¿", detail: "ä¸€æ–¹æ‰¿è¯ºèµ”å¿å¦ä¸€æ–¹é­å—çš„æŸå¤±ã€‚", context: "Contract" },
                { id: 'l3', en: "Force Majeure", zh: "ä¸å¯æŠ—åŠ›", detail: "ä¸èƒ½é¢„è§ã€é¿å…ä¸”å…‹æœçš„å®¢è§‚æƒ…å†µã€‚", context: "General" },
                { id: 'l4', en: "Due Diligence", zh: "å°½èŒè°ƒæŸ¥", detail: "ç­¾ç½²åˆåŒå‰çš„å…¨é¢å®¡æŸ¥ã€‚", context: "Corporate" },
                { id: 'l5', en: "Joint and Several Liability", zh: "è¿å¸¦è´£ä»»", detail: "ä¸¤ä¸ªæˆ–å¤šä¸ªä¸»ä½“å…±åŒæ‰¿æ‹…å€ºåŠ¡ã€‚", context: "Tort" },
                { id: 'l6', en: "Breach of Contract", zh: "è¿çº¦", detail: "æœªèƒ½æŒ‰ç…§åˆåŒçº¦å®šå±¥è¡Œä¹‰åŠ¡ã€‚", context: "Contract" },
                { id: 'l7', en: "Arbitration", zh: "ä»²è£", detail: "æäº¤ç¬¬ä¸‰æ–¹è£å†³çš„çº çº·è§£å†³æ–¹å¼ã€‚", context: "Dispute" },
                { id: 'l8', en: "Intellectual Property", zh: "çŸ¥è¯†äº§æƒ", detail: "å…³äºä½œå“ã€å‘æ˜ç­‰æ™ºåŠ›æˆæœçš„æƒåˆ©ã€‚", context: "IP Law" },
                { id: 'l9', en: "Statute of Limitations", zh: "è¯‰è®¼æ—¶æ•ˆ", detail: "æƒåˆ©äººè¯·æ±‚æƒçš„æ³•å®šæœŸé—´ã€‚", context: "Litigation" },
                { id: 'l10', en: "Articles of Association", zh: "å…¬å¸ç« ç¨‹", detail: "è§„å®šå…¬å¸ç»„ç»‡åŸåˆ™çš„åŸºæœ¬å‡†åˆ™ã€‚", context: "Corporate" },
                { id: 'l11', en: "Power of Attorney", zh: "æˆæƒå§”æ‰˜ä¹¦", detail: "ä¹¦é¢æˆæƒä»–äººè¡Œä½¿æ³•å¾‹æƒåŠ›çš„æ–‡ä»¶ã€‚", context: "Agency" },
                { id: 'l12', en: "Liquidated Damages", zh: "çº¦å®šè¿çº¦é‡‘", detail: "é¢„å…ˆçº¦å®šçš„è¿çº¦å‘ç”Ÿæ—¶éœ€æ”¯ä»˜çš„é‡‘é¢ã€‚", context: "Contract" },
                { id: 'l13', en: "Good Faith", zh: "è¯šå®ä¿¡ç”¨", detail: "æ°‘æ³•åŸºæœ¬åŸåˆ™ï¼Œè¦æ±‚è¯šå®å®ˆä¿¡ã€‚", context: "Civil" },
                { id: 'l14', en: "Burden of Proof", zh: "ä¸¾è¯è´£ä»»", detail: "å½“äº‹äººå¯¹è‡ªå·±ä¸»å¼ æœ‰è¯æ˜è´£ä»»ã€‚", context: "Evidence" },
                { id: 'l15', en: "Conflict of Interest", zh: "åˆ©ç›Šå†²çª", detail: "ä¸ªäººåˆ©ç›Šä¸èŒå®ˆä¹‹é—´çš„ç«äº‰çŠ¶æ€ã€‚", context: "Ethics" },
                { id: 'l16', en: "Confidentiality Agreement", zh: "ä¿å¯†åè®®", detail: "ä¿—ç§°NDAï¼Œçº¦å®šä¸æ³„éœ²ä¿¡æ¯çš„åè®®ã€‚", context: "Contract" },
                { id: 'l17', en: "Exclusive Jurisdiction", zh: "ä¸“å±ç®¡è¾–", detail: "ç‰¹å®šæ¡ˆä»¶åªèƒ½ç”±ç‰¹å®šæ³•é™¢å—ç†ã€‚", context: "Litigation" },
                { id: 'l18', en: "Termination for Convenience", zh: "ä»»æ„è§£é™¤", detail: "æ— éœ€ç†ç”±å³å¯ç»ˆæ­¢åˆåŒçš„æƒåˆ©ã€‚", context: "Contract" },
                { id: 'l19', en: "Duty of Care", zh: "æ³¨æ„ä¹‰åŠ¡", detail: "æ³•å¾‹è¦æ±‚ä¸ªäººåº”è¾¾åˆ°çš„åˆç†è°¨æ…ç¨‹åº¦ã€‚", context: "Tort" },
                { id: 'l20', en: "Legal Entity", zh: "æ³•äººå®ä½“", detail: "ç‹¬ç«‹æ‰¿æ‹…æ°‘äº‹è´£ä»»çš„ç»„ç»‡ã€‚", context: "Corporate" },
                { id: 'l21', en: "Governing Law", zh: "ç®¡è¾–æ³•å¾‹", detail: "è§£å†³äº‰è®®æ‰€é€‚ç”¨çš„å›½å®¶æ³•å¾‹ã€‚", context: "General" },
                { id: 'l22', en: "Service of Process", zh: "æ–‡ä¹¦é€è¾¾", detail: "æ­£å¼äº¤ä»˜æ³•å¾‹æ–‡ä¹¦çš„æ³•å®šç¨‹åºã€‚", context: "Procedure" },
                { id: 'l23', en: "Injunction", zh: "ç¦ä»¤", detail: "æ³•é™¢å‘å¸ƒçš„å¼ºåˆ¶æˆ–ç¦æ­¢å‘½ä»¤ã€‚", context: "Litigation" },
                { id: 'l24', en: "Assignment", zh: "è½¬è®©", detail: "å°†åˆåŒæƒåˆ©ç§»äº¤ç»™ç¬¬ä¸‰æ–¹çš„è¡Œä¸ºã€‚", context: "Contract" },
                { id: 'l25', en: "Pro Bono", zh: "æ³•å¾‹æ´åŠ©", detail: "ä¸ºå…¬ä¼—åˆ©ç›Šè€Œå…è´¹æä¾›çš„ä¸“ä¸šæœåŠ¡ã€‚", context: "Practice" },
                { id: 'l26', en: "Reasonable Doubt", zh: "åˆç†æ€€ç–‘", detail: "åˆ‘äº‹è¯‰è®¼ä¸­å®šç½ªå¿…é¡»æ’é™¤çš„æ ‡å‡†ã€‚", context: "Criminal" },
                { id: 'l27', en: "Non-Compete Clause", zh: "ç«ä¸šé™åˆ¶", detail: "ç¦»èŒåä¸å¾—ä»äº‹ç«äº‰æ€§ä¸šåŠ¡çš„çº¦å®šã€‚", context: "Employment" },
                { id: 'l28', en: "Public Domain", zh: "å…¬æœ‰é¢†åŸŸ", detail: "ä¸å†å—çŸ¥è¯†äº§æƒä¿æŠ¤çš„ä½œå“ã€‚", context: "IP Law" },
                { id: 'l29', en: "Precedent", zh: "åˆ¤ä¾‹", detail: "å…·æœ‰æŒ‡å¯¼æˆ–çº¦æŸåŠ›çš„å…ˆå‰è£å†³ã€‚", context: "Common Law" },
                { id: 'l30', en: "Waiver", zh: "å¼ƒæƒ", detail: "è‡ªæ„¿æ”¾å¼ƒå·²çŸ¥æƒåˆ©çš„æ³•å¾‹è¡Œä¸ºã€‚", context: "Contract" }
            ],
            gaming: [
                { id: 'g1', en: "Fog of War", zh: "æˆ˜äº‰è¿·é›¾", detail: "åœ°å›¾ä¸Šæœªæ¢ç´¢åŒºåŸŸè¢«è¦†ç›–çš„æœºåˆ¶ã€‚", context: "MOBA" },
                { id: 'g2', en: "Cooldown", zh: "å†·å´æ—¶é—´", detail: "å†æ¬¡ä½¿ç”¨æŠ€èƒ½å‰å¿…é¡»ç­‰å¾…çš„æ—¶é—´ã€‚", context: "Mechanics" },
                { id: 'g3', en: "Aggro", zh: "ä»‡æ¨å€¼", detail: "æ€ªç‰©å¯¹ç©å®¶æ”»å‡»æ¬²æœ›çš„æ•°å€¼ã€‚", context: "MMO" },
                { id: 'g4', en: "Buff / Debuff", zh: "å¢ç›Š/å‡ç›Š", detail: "å±æ€§çš„æ­£é¢æˆ–è´Ÿé¢å½±å“ã€‚", context: "General" },
                { id: 'g5', en: "Easter Egg", zh: "å½©è›‹", detail: "éšè—çš„æƒŠå–œä¿¡æ¯æˆ–ç§˜å¯†å…³å¡ã€‚", context: "Content" },
                { id: 'g6', en: "Hitbox", zh: "ç¢°æ’æ¡†", detail: "æ£€æµ‹ç¢°æ’çš„éšå½¢å‡ ä½•ä½“ã€‚", context: "Combat" },
                { id: 'g7', en: "Proc", zh: "è§¦å‘", detail: "ç‰¹å®šæ¦‚ç‡æ•ˆæœè¢«æ¿€æ´»ã€‚", context: "Mechanics" },
                { id: 'g8', en: "Loot Box", zh: "å¼€ç®±", detail: "åŒ…å«éšæœºå¥–åŠ±çš„å®¹å™¨ã€‚", context: "Business" },
                { id: 'g9', en: "Fast Travel", zh: "å¿«é€Ÿæ—…è¡Œ", detail: "åœ¨å‘ç°åœ°ç‚¹é—´ç¬é—´ç§»åŠ¨ã€‚", context: "Exploration" },
                { id: 'g10', en: "Permadeath", zh: "æ°¸ä¹…æ­»äº¡", detail: "ä¸€æ—¦æ­»äº¡è¿›åº¦å³å¤±æ•ˆã€‚", context: "Roguelike" },
                { id: 'g11', en: "Quality of Life", zh: "ä½“éªŒä¼˜åŒ–", detail: "è®©æ“ä½œæ›´ä¾¿æ·çš„å°æ”¹åŠ¨ã€‚", context: "Dev" },
                { id: 'g12', en: "NPC", zh: "éç©å®¶è§’è‰²", detail: "ç”±ç”µè„‘æ§åˆ¶çš„è§’è‰²ã€‚", context: "General" },
                { id: 'g13', en: "Meta", zh: "ä¸»æµç­–ç•¥", detail: "å½“å‰ç‰ˆæœ¬å…¬è®¤çš„æœ€ä¼˜ç©æ³•ã€‚", context: "Meta" },
                { id: 'g14', en: "New Game Plus", zh: "äºŒå‘¨ç›®", detail: "é€šå…³åå¸¦è£…å¤‡é‡æ–°å¼€å§‹ã€‚", context: "Prog" },
                { id: 'g15', en: "Microtransaction", zh: "å†…è´­", detail: "æ¸¸æˆå†…å°é¢æ¶ˆè´¹è¡Œä¸ºã€‚", context: "Business" },
                { id: 'g16', en: "Sandbox", zh: "æ²™ç›’", detail: "é«˜è‡ªç”±åº¦çš„åˆ›é€ ç©æ³•ã€‚", context: "Genre" },
                { id: 'g17', en: "Vertical Slice", zh: "å‚ç›´åˆ‡ç‰‡", detail: "å±•ç¤ºæˆå“è´¨æ„Ÿçš„å®Œæ•´åŸå‹ã€‚", context: "Industry" },
                { id: 'g18', en: "Spawn", zh: "ç”Ÿæˆ", detail: "åœ¨åœ°å›¾ä¸Šå‡ºç°çš„è¿‡ç¨‹ã€‚", context: "Mechanics" },
                { id: 'g19', en: "Gacha", zh: "æŠ½å¡", detail: "éšæœºè·å–ç¨€æœ‰å¥–åŠ±çš„ç©æ³•ã€‚", context: "Business" },
                { id: 'g20', en: "Haptic Feedback", zh: "è§¦è§‰åé¦ˆ", detail: "ç»†è…»çš„éœ‡åŠ¨æ•ˆæœã€‚", context: "Hardware" },
                { id: 'g21', en: "Skill Tree", zh: "æŠ€èƒ½æ ‘", detail: "å±•ç¤ºè§’è‰²æˆé•¿è·¯å¾„çš„å›¾ã€‚", context: "Prog" },
                { id: 'g22', en: "Ray Tracing", zh: "å…‰çº¿è¿½è¸ª", detail: "æ¨¡æ‹Ÿå…‰çº¿è¡Œä¸ºçš„æŠ€æœ¯ã€‚", context: "Graphics" },
                { id: 'g23', en: "Grinding", zh: "åˆ·æ€ª", detail: "æœºæ¢°æ€§é‡å¤æˆ˜æ–—ã€‚", context: "General" },
                { id: 'g24', en: "Early Access", zh: "æŠ¢å…ˆä½“éªŒ", detail: "æœªå®Œå·¥å³å¼€æ”¾è´­ä¹°æµ‹è¯•ã€‚", context: "Industry" },
                { id: 'g25', en: "Speedrun", zh: "é€Ÿé€š", detail: "æœ€å¿«é€Ÿåº¦å®Œæˆæ¸¸æˆã€‚", context: "Comp" },
                { id: 'g26', en: "Dynamic Weather", zh: "åŠ¨æ€å¤©æ°”", detail: "éšæ—¶é—´å˜åŒ–çš„ç³»ç»Ÿã€‚", context: "Env" },
                { id: 'g27', en: "Mana / MP", zh: "æ³•åŠ›å€¼", detail: "æ–½æ³•æ¶ˆè€—çš„èƒ½é‡ã€‚", context: "Attrib" },
                { id: 'g28', en: "Side Quest", zh: "æ”¯çº¿ä»»åŠ¡", detail: "éä¸»çº¿å‰§æƒ…çš„é¢å¤–ä»»åŠ¡ã€‚", context: "Prog" },
                { id: 'g29', en: "DLC", zh: "æ‰©å±•åŒ…", detail: "é¢å¤–å‘å¸ƒçš„æ•°å­—å†…å®¹ã€‚", context: "Business" },
                { id: 'g30', en: "Mod", zh: "æ¨¡ç»„", detail: "ç©å®¶å¼€å‘çš„ä¿®æ”¹æ’ä»¶ã€‚", context: "Community" }
            ],
            food: [
                { id: 'f1', en: "Maillard Reaction", zh: "ç¾æ‹‰å¾·ååº”", detail: "é«˜æ¸©ä¸‹äº§ç”Ÿçš„è¤å˜ååº”ã€‚", context: "Science" },
                { id: 'f2', en: "Stir-fry", zh: "ç…¸ç‚’", detail: "ä¸­é¤æœ€åŸºç¡€çš„ç¿»ç‚’æŠ€æ³•ã€‚", context: "Technique" },
                { id: 'f3', en: "Al Dente", zh: "å¼¹ç‰™", detail: "æ„é¢ç…®å¾—æ°åˆ°å¥½å¤„ã€‚", context: "Texture" },
                { id: 'f4', en: "Aroma Wheel", zh: "é£å‘³è½®", detail: "æè¿°é£å‘³çš„æ°”å‘³å›¾è°±ã€‚", context: "Tasting" },
                { id: 'f5', en: "Red-braised", zh: "çº¢çƒ§", detail: "åˆ©ç”¨é…±æ²¹å†°ç³–ä¸Šè‰²çš„æŠ€æ³•ã€‚", context: "Technique" },
                { id: 'f6', en: "Farm-to-table", zh: "å†œåœºåˆ°é¤æ¡Œ", detail: "é£Ÿææ¥æºæ–°é²œçš„ç†å¿µã€‚", context: "Concept" },
                { id: 'f7', en: "Acidity", zh: "é…¸åº¦", detail: "æ˜äº®é…¸æ„Ÿï¼ŒåŒºåˆ«äºå˜è´¨ã€‚", context: "Tasting" },
                { id: 'f8', en: "Simmer", zh: "æ–‡ç«æ…¢ç‚–", detail: "ä¿æŒæ¶²ä½“æ¥è¿‘æ²¸ç‚¹åŠ çƒ­ã€‚", context: "Technique" },
                { id: 'f9', en: "Palate Cleanser", zh: "æ¸…å£èœ", detail: "æ¸…é™¤å‰ä¸€é“èœçš„ä½™å‘³ã€‚", context: "Dining" },
                { id: 'f10', en: "Wok Hei", zh: "é•¬æ°”", detail: "é«˜æ¸©äº§ç”Ÿçš„å¤æ‚ç„¦é¦™ã€‚", context: "Technique" },
                { id: 'f11', en: "Mouthfeel", zh: "å£æ„Ÿ", detail: "è…”å†…äº§ç”Ÿçš„ç‰©ç†æ„Ÿå—ã€‚", context: "Tasting" },
                { id: 'f12', en: "Deep-fry", zh: "æ²¹ç‚¸", detail: "æµ¸å…¥æ²¹è„‚è·å¾—é…¥è„†å¤–çš®ã€‚", context: "Technique" },
                { id: 'f13', en: "Umami", zh: "é²œå‘³", detail: "ç¬¬äº”ç§åŸºæœ¬å‘³é“ã€‚", context: "Tasting" },
                { id: 'f14', en: "Sous-vide", zh: "ä½æ¸©æ…¢ç…®", detail: "çœŸç©ºæ’æ¸©æ°´æµ´åŠ çƒ­ã€‚", context: "Molecular" },
                { id: 'f15', en: "Blanch", zh: "ç„¯æ°´", detail: "çŸ­æš‚æ”¾å…¥æ²¸æ°´ä¸­çƒ«æ´—ã€‚", context: "Technique" },
                { id: 'f16', en: "Sommelier", zh: "ä¾é…’å¸ˆ", detail: "è´Ÿè´£é…’æ°´é€‰é…çš„ä¸“å®¶ã€‚", context: "Profession" },
                { id: 'f17', en: "Infusion", zh: "æµ¸æ¸", detail: "æå–é£å‘³çš„è¿‡ç¨‹ã€‚", context: "Technique" },
                { id: 'f18', en: "Zest", zh: "çš®å±‘", detail: "æŸ‘æ©˜æœ€å¤–å±‚çš„èŠ³é¦™çš®ã€‚", context: "Ingredient" },
                { id: 'f19', en: "Dim Sum", zh: "ç‚¹å¿ƒ", detail: "ç²¤å¼ç²¾è‡´å°åƒã€‚", context: "Cuisine" },
                { id: 'f20', en: "Decant", zh: "é†’é…’", detail: "ä¸ç©ºæ°”æ¥è§¦é‡Šæ”¾é¦™æ°”ã€‚", context: "Tasting" },
                { id: 'f21', en: "Crispy", zh: "é…¥è„†", detail: "æ˜“ç¢çš„è–„è„†è´¨æ„Ÿã€‚", context: "Texture" },
                { id: 'f22', en: "Garnish", zh: "ç›˜é¥°", detail: "ç”¨äºç‚¹ç¼€é£å‘³çš„é£Ÿæã€‚", context: "Pres" },
                { id: 'f23', en: "Steaming", zh: "è’¸", detail: "ä¿ç•™åŸå‘³è¥å…»çš„çƒ¹é¥ªã€‚", context: "Technique" },
                { id: 'f24', en: "Tannin", zh: "å•å®", detail: "æ¶©æ„Ÿæ¥æºï¼Œæ¥è‡ªçš®ç±½ã€‚", context: "Tasting" },
                { id: 'f25', en: "Fermentation", zh: "å‘é…µ", detail: "å¾®ç”Ÿç‰©è½¬åŒ–æˆåˆ†çš„è¿‡ç¨‹ã€‚", context: "Science" },
                { id: 'f26', en: "Velveting", zh: "ä¸Šæµ†", detail: "è‚‰ç±»åŒ…è£¹æ·€ç²‰ä¿æŒé²œå«©ã€‚", context: "Technique" },
                { id: 'f27', en: "Body", zh: "é†‡åšåº¦", detail: "é¥®æ–™åœ¨å£ä¸­çš„é‡é‡æ„Ÿã€‚", context: "Tasting" },
                { id: 'f28', en: "Glaze", zh: "æŒ‚æ±", detail: "è¡¨é¢æ¶‚æŠ¹å‘äº®æ¶²ä½“ã€‚", context: "Pres" },
                { id: 'f29', en: "Offal", zh: "å†…è„", detail: "åŠ¨ç‰©çš„å¯é£Ÿç”¨å™¨å®˜ã€‚", context: "Ingredient" },
                { id: 'f30', en: "Aftertaste", zh: "ä½™éŸµ", detail: "åå’½åæŒç»­çš„é£å‘³ã€‚", context: "Tasting" }
            ]
        };

        let currentCategory = 'all';
        let isDark = false;
        const intervals = [0, 1, 12, 24, 48, 168, 360, 720];

        function getMem() { return JSON.parse(localStorage.getItem('lexi_v2') || '{}'); }
        function saveMem(id, known) {
            let m = getMem();
            let r = m[id] || { level: 0, time: 0 };
            known ? r.level = Math.min(r.level + 1, 7) : r.level = Math.max(r.level - 1, 0);
            r.time = Date.now() + intervals[r.level] * 3600000;
            m[id] = r;
            localStorage.setItem('lexi_v2', JSON.stringify(m));
            renderAll();
        }

        function switchView(view) {
            document.getElementById('view-learn').classList.toggle('view-hidden', view !== 'learn');
            document.getElementById('view-search').classList.toggle('view-hidden', view !== 'search');
            document.getElementById('dock-learn').classList.toggle('dock-item-active', view === 'learn');
            document.getElementById('dock-search').classList.toggle('dock-item-active', view === 'search');
            if(view === 'learn') renderLearn(); else renderSearch();
        }

        function renderSearch() {
            const query = document.getElementById('global-search').value.toLowerCase();
            let allItems = [];
            if(currentCategory === 'all') {
                Object.values(vocabulary).forEach(cat => allItems.push(...cat));
            } else {
                allItems = vocabulary[currentCategory] || [];
            }

            // A-Z è‡ªåŠ¨æ’åº
            allItems.sort((a, b) => a.en.localeCompare(b.en));

            const filtered = allItems.filter(i => i.en.toLowerCase().includes(query) || i.zh.includes(query));
            const mem = getMem();

            document.getElementById('search-results').innerHTML = filtered.map(item => `
                <div class="glass-card p-6 rounded-3xl flex justify-between items-center group transition-all hover:scale-[1.02]">
                    <div>
                        <h3 class="font-bold text-lg">${item.en}</h3>
                        <p class="text-gray-400 text-sm">${item.zh}</p>
                    </div>
                    <div class="flex flex-col items-end">
                        <span class="text-[8px] text-blue-500 font-mono mb-1 uppercase tracking-tighter">${mem[item.id] ? 'Level '+mem[item.id].level : ''}</span>
                        <div class="text-[8px] space-x-1 opacity-20 group-hover:opacity-100 transition-opacity">
                            ${Array.from({length:7}).map((_,i) => `<span class="memory-dot ${i < (mem[item.id]?.level || 0) ? 'bg-blue-500' : 'bg-gray-300'}"></span>`).join('')}
                        </div>
                    </div>
                </div>
            `).join('');

            if(!query && allItems.length > 0) {
                const dayIndex = Math.floor(Date.now()/86400000);
                const feat = allItems[dayIndex % allItems.length];
                document.getElementById('feat-en').innerText = feat.en;
                document.getElementById('feat-zh').innerText = feat.zh;
                document.getElementById('feat-detail').innerText = feat.detail;
            }
        }

        function renderLearn() {
            const mem = getMem();
            const now = Date.now();
            const allItems = Object.values(vocabulary).flat();
            const toReview = allItems.filter(i => mem[i.id] && mem[i.id].time < now);
            
            document.getElementById('dash-learned').innerText = Object.keys(mem).length;
            document.getElementById('dash-review').innerText = toReview.length;

            const container = document.getElementById('learn-card-container');
            if(toReview.length === 0) {
                document.getElementById('learn-empty').classList.remove('view-hidden');
                container.innerHTML = '';
            } else {
                document.getElementById('learn-empty').classList.add('view-hidden');
                const nextItem = toReview[0];
                container.innerHTML = `
                    <div class="glass-card p-12 rounded-[3.5rem] shadow-2xl text-center border-b-8 border-blue-500/20">
                        <h2 class="text-5xl font-bold mb-6 serif-title tracking-tighter">${nextItem.en}</h2>
                        <div class="h-20 flex items-center justify-center mb-8">
                            <p class="text-gray-300 dark:text-gray-600 text-sm hover:text-blue-500 cursor-pointer transition-all" onclick="this.innerHTML='<span class=\'text-2xl font-bold text-slate-800 dark:text-white\'>${nextItem.zh}</span><br><span class=\'text-xs mt-2 block\'>${nextItem.detail}</span>'">ç‚¹å‡»æ­æ™“ç­”æ¡ˆ</p>
                        </div>
                        <div class="flex space-x-4">
                            <button onclick="saveMem('${nextItem.id}', true)" class="flex-1 py-5 rounded-3xl bg-blue-600 text-white font-bold shadow-lg active:scale-95 transition-all">è®¤è¯†</button>
                            <button onclick="saveMem('${nextItem.id}', false)" class="flex-1 py-5 rounded-3xl bg-slate-100 text-slate-400 dark:bg-slate-800 font-bold active:scale-95 transition-all">æ¨¡ç³Š</button>
                        </div>
                    </div>
                `;
            }
        }

        function setCategory(cat) {
            currentCategory = cat;
            renderSearch();
            // æŒ‰é’®é«˜äº®å¤„ç†
            ['all', 'legal', 'gaming', 'food'].forEach(c => {
                document.getElementById('cat-'+c).classList.toggle('bg-blue-500', c === cat);
                document.getElementById('cat-'+c).classList.toggle('text-white', c === cat);
            });
        }

        function toggleDarkMode() {
            isDark = !isDark;
            document.body.classList.toggle('dark-mode');
            document.getElementById('dark-icon').innerText = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
        }

        function renderAll() {
            renderSearch();
            renderLearn();
        }

        window.onload = () => { renderAll(); switchView('search'); setCategory('all'); };
    </script>
</body>
</html>
